{
  "training_timestamp": "2026-02-10 15:48:21",
  "training_duration_seconds": 422.1,
  "pipeline_version": "3.0 (ensemble + visualizations)",
  "dataset": {
    "normal_total": 20000,
    "attack_total": 8000,
    "normal_train": 14000,
    "normal_val": 3000,
    "normal_test": 3000,
    "attack_val": 1200,
    "attack_test": 1200
  },
  "features": {
    "all": [
      "packet_rate",
      "unique_ports",
      "avg_packet_size",
      "duration",
      "protocol_flag",
      "connection_count",
      "bytes_per_second",
      "port_scan_ratio",
      "size_rate_ratio",
      "conn_rate",
      "burst_intensity",
      "traffic_efficiency",
      "port_diversity",
      "connection_density",
      "size_deviation",
      "duration_efficiency",
      "rate_concentration"
    ],
    "raw": [
      "packet_rate",
      "unique_ports",
      "avg_packet_size",
      "duration",
      "protocol_flag",
      "connection_count"
    ],
    "derived": [
      "bytes_per_second",
      "port_scan_ratio",
      "size_rate_ratio",
      "conn_rate",
      "burst_intensity",
      "traffic_efficiency",
      "port_diversity",
      "connection_density",
      "size_deviation",
      "duration_efficiency",
      "rate_concentration"
    ],
    "count": 17
  },
  "scaler": {
    "means": [
      248.16869285714188,
      3.8946428571428573,
      711.0188142857127,
      29.830449999999924,
      0.5040714285714286,
      8.777571428571429,
      209579.3995857137,
      0.6602514000000006,
      7.7851732857143405,
      1.1399543928571425,
      6.410206172701845,
      225.20698405714117,
      1.6750523357142504,
      0.08306582142857145,
      401.47877142857226,
      19507.838978571497,
      115.98820889285713
    ],
    "stds": [
      322.96650302956914,
      3.915204776748998,
      433.24181236054807,
      37.86563684281262,
      0.6435264412688578,
      14.059936388365353,
      300812.9361879412,
      1.6845513015881566,
      11.282753153312452,
      2.7442703074680446,
      1.8201906220152402,
      295.99771064064663,
      1.4041861434532183,
      0.11900180721183393,
      257.1415028915944,
      64158.8262151173,
      190.9669320746986
    ]
  },
  "best_hyperparameters": {
    "n_estimators": 100,
    "contamination": 0.02,
    "max_features": 0.6,
    "max_samples": 0.85
  },
  "hyperparameter_search": {
    "total_combinations": 320,
    "top_5": [
      {
        "n_estimators": 100,
        "contamination": 0.02,
        "max_features": 0.6,
        "max_samples": "0.85",
        "f1": 0.9316,
        "recall": 0.9075,
        "fpr": 0.0163
      },
      {
        "n_estimators": 100,
        "contamination": 0.03,
        "max_features": 0.6,
        "max_samples": "0.75",
        "f1": 0.9308,
        "recall": 0.9242,
        "fpr": 0.0247
      },
      {
        "n_estimators": 100,
        "contamination": 0.025,
        "max_features": 0.6,
        "max_samples": "0.85",
        "f1": 0.9292,
        "recall": 0.9183,
        "fpr": 0.0233
      },
      {
        "n_estimators": 300,
        "contamination": 0.025,
        "max_features": 0.6,
        "max_samples": "0.75",
        "f1": 0.9291,
        "recall": 0.9125,
        "fpr": 0.0207
      },
      {
        "n_estimators": 200,
        "contamination": 0.025,
        "max_features": 0.85,
        "max_samples": "0.85",
        "f1": 0.9289,
        "recall": 0.915,
        "fpr": 0.022
      }
    ]
  },
  "cross_validation": {
    "avg_fp_rate": 0.0219,
    "std_fp_rate": 0.0042,
    "fold_fp_rates": [
      0.0229,
      0.015,
      0.0218,
      0.0282,
      0.0214
    ]
  },
  "model_metrics": {
    "isolation_forest": {
      "model": "Isolation Forest (tuned)",
      "precision": 0.9442,
      "recall": 0.9017,
      "f1_score": 0.9224,
      "roc_auc": 0.9833,
      "normal_accuracy": 0.9787,
      "attack_detection_rate": 0.9017,
      "false_positive_rate": 0.0213,
      "confusion_matrix": [
        [
          2936,
          64
        ],
        [
          118,
          1082
        ]
      ],
      "per_attack_type": {
        "brute_force": {
          "detected": 63,
          "total": 115,
          "rate": 0.5478
        },
        "dns_amplification": {
          "detected": 135,
          "total": 135,
          "rate": 1.0
        },
        "http_flood": {
          "detected": 115,
          "total": 128,
          "rate": 0.8984
        },
        "icmp_flood": {
          "detected": 97,
          "total": 97,
          "rate": 1.0
        },
        "port_scan": {
          "detected": 127,
          "total": 127,
          "rate": 1.0
        },
        "protocol_anomaly": {
          "detected": 104,
          "total": 117,
          "rate": 0.8889
        },
        "slowloris": {
          "detected": 102,
          "total": 105,
          "rate": 0.9714
        },
        "stealth_probe": {
          "detected": 103,
          "total": 140,
          "rate": 0.7357
        },
        "syn_flood": {
          "detected": 125,
          "total": 125,
          "rate": 1.0
        },
        "udp_flood": {
          "detected": 111,
          "total": 111,
          "rate": 1.0
        }
      }
    },
    "one_class_svm": {
      "model": "One-Class SVM",
      "precision": 0.8807,
      "recall": 0.9475,
      "f1_score": 0.9129,
      "roc_auc": 0.9859,
      "normal_accuracy": 0.9487,
      "attack_detection_rate": 0.9475,
      "false_positive_rate": 0.0513,
      "confusion_matrix": [
        [
          2846,
          154
        ],
        [
          63,
          1137
        ]
      ]
    },
    "local_outlier_factor": {
      "model": "Local Outlier Factor",
      "precision": 0.9437,
      "recall": 0.9217,
      "f1_score": 0.9325,
      "roc_auc": 0.9839,
      "normal_accuracy": 0.978,
      "attack_detection_rate": 0.9217,
      "false_positive_rate": 0.022,
      "confusion_matrix": [
        [
          2934,
          66
        ],
        [
          94,
          1106
        ]
      ]
    },
    "ensemble": {
      "model": "Ensemble (IF+LOF)",
      "precision": 0.903,
      "recall": 0.9467,
      "f1_score": 0.9243,
      "roc_auc": 0.9833,
      "normal_accuracy": 0.9593,
      "attack_detection_rate": 0.9467,
      "false_positive_rate": 0.0407,
      "confusion_matrix": [
        [
          2878,
          122
        ],
        [
          64,
          1136
        ]
      ],
      "per_attack_type": {
        "brute_force": {
          "detected": 85,
          "total": 115,
          "rate": 0.7391
        },
        "dns_amplification": {
          "detected": 135,
          "total": 135,
          "rate": 1.0
        },
        "http_flood": {
          "detected": 116,
          "total": 128,
          "rate": 0.9062
        },
        "icmp_flood": {
          "detected": 97,
          "total": 97,
          "rate": 1.0
        },
        "port_scan": {
          "detected": 127,
          "total": 127,
          "rate": 1.0
        },
        "protocol_anomaly": {
          "detected": 117,
          "total": 117,
          "rate": 1.0
        },
        "slowloris": {
          "detected": 104,
          "total": 105,
          "rate": 0.9905
        },
        "stealth_probe": {
          "detected": 119,
          "total": 140,
          "rate": 0.85
        },
        "syn_flood": {
          "detected": 125,
          "total": 125,
          "rate": 1.0
        },
        "udp_flood": {
          "detected": 111,
          "total": 111,
          "rate": 1.0
        }
      }
    }
  },
  "learning_curve": [
    {
      "fraction": 0.1,
      "n_samples": 1400,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.9115,
      "val_fpr": 0.014,
      "val_recall": 0.8667,
      "val_precision": 0.9612,
      "val_accuracy": 0.986,
      "test_f1": 0.9024,
      "test_fpr": 0.0197,
      "test_recall": 0.8625,
      "test_accuracy": 0.9803
    },
    {
      "fraction": 0.2,
      "n_samples": 2800,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.9156,
      "val_fpr": 0.0217,
      "val_recall": 0.89,
      "val_precision": 0.9426,
      "val_accuracy": 0.9783,
      "test_f1": 0.9069,
      "test_fpr": 0.0247,
      "test_recall": 0.8808,
      "test_accuracy": 0.9753
    },
    {
      "fraction": 0.3,
      "n_samples": 4200,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.9125,
      "val_fpr": 0.0207,
      "val_recall": 0.8825,
      "val_precision": 0.9447,
      "val_accuracy": 0.9793,
      "test_f1": 0.9085,
      "test_fpr": 0.0233,
      "test_recall": 0.8808,
      "test_accuracy": 0.9767
    },
    {
      "fraction": 0.5,
      "n_samples": 7000,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.919,
      "val_fpr": 0.018,
      "val_recall": 0.8883,
      "val_precision": 0.9518,
      "val_accuracy": 0.982,
      "test_f1": 0.9078,
      "test_fpr": 0.0247,
      "test_recall": 0.8825,
      "test_accuracy": 0.9753
    },
    {
      "fraction": 0.7,
      "n_samples": 9800,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.9257,
      "val_fpr": 0.017,
      "val_recall": 0.8983,
      "val_precision": 0.9548,
      "val_accuracy": 0.983,
      "test_f1": 0.918,
      "test_fpr": 0.0223,
      "test_recall": 0.8958,
      "test_accuracy": 0.9777
    },
    {
      "fraction": 0.85,
      "n_samples": 11900,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.927,
      "val_fpr": 0.019,
      "val_recall": 0.905,
      "val_precision": 0.9501,
      "val_accuracy": 0.981,
      "test_f1": 0.9179,
      "test_fpr": 0.024,
      "test_recall": 0.8992,
      "test_accuracy": 0.976
    },
    {
      "fraction": 1.0,
      "n_samples": 14000,
      "train_accuracy": 0.98,
      "train_fpr": 0.02,
      "val_f1": 0.9316,
      "val_fpr": 0.0163,
      "val_recall": 0.9075,
      "val_precision": 0.9569,
      "val_accuracy": 0.9837,
      "test_f1": 0.9224,
      "test_fpr": 0.0213,
      "test_recall": 0.9017,
      "test_accuracy": 0.9787
    }
  ],
  "feature_importance": {
    "bytes_per_second": {
      "mean": 0.012245,
      "std": 0.000194,
      "relative": 11.04
    },
    "packet_rate": {
      "mean": 0.011366,
      "std": 0.000198,
      "relative": 10.25
    },
    "avg_packet_size": {
      "mean": 0.010554,
      "std": 0.000182,
      "relative": 9.52
    },
    "burst_intensity": {
      "mean": 0.009113,
      "std": 8.6e-05,
      "relative": 8.22
    },
    "traffic_efficiency": {
      "mean": 0.008119,
      "std": 0.000153,
      "relative": 7.32
    },
    "connection_count": {
      "mean": 0.007683,
      "std": 0.000111,
      "relative": 6.93
    },
    "duration": {
      "mean": 0.007226,
      "std": 0.000119,
      "relative": 6.52
    },
    "rate_concentration": {
      "mean": 0.005709,
      "std": 5.2e-05,
      "relative": 5.15
    },
    "unique_ports": {
      "mean": 0.005582,
      "std": 9e-05,
      "relative": 5.03
    },
    "size_deviation": {
      "mean": 0.005277,
      "std": 0.000102,
      "relative": 4.76
    },
    "conn_rate": {
      "mean": 0.005258,
      "std": 7.7e-05,
      "relative": 4.74
    },
    "connection_density": {
      "mean": 0.004871,
      "std": 6.9e-05,
      "relative": 4.39
    },
    "size_rate_ratio": {
      "mean": 0.004807,
      "std": 8.6e-05,
      "relative": 4.34
    },
    "port_scan_ratio": {
      "mean": 0.003453,
      "std": 4e-05,
      "relative": 3.11
    },
    "port_diversity": {
      "mean": 0.003394,
      "std": 8e-05,
      "relative": 3.06
    },
    "duration_efficiency": {
      "mean": 0.003143,
      "std": 6.2e-05,
      "relative": 2.83
    },
    "protocol_flag": {
      "mean": 0.003072,
      "std": 0.000103,
      "relative": 2.77
    }
  },
  "ensemble_config": {
    "if_weight": 0.5,
    "lof_weight": 0.5,
    "threshold": 0.4
  },
  "visualizations": [
    "confusion_matrix.png",
    "confusion_matrices_all.png",
    "roc_curves.png",
    "learning_curves.png",
    "per_attack_detection.png",
    "feature_importance.png",
    "score_distribution.png",
    "model_comparison.png",
    "cross_validation.png"
  ]
}