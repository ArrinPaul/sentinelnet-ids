============================================================
  SentinelNet ML Training Pipeline v3.0
  Anti-Overfitting + Ensemble + Visualizations
============================================================
  Started: 2026-02-10 14:50:42

  Loaded 20,000 normal samples
  Loaded 8,000 attack samples
  Attack types: {'udp_flood': 800, 'slowloris': 800, 'protocol_anomaly': 800, 'syn_flood': 800, 'dns_amplification': 800, 'stealth_probe': 800, 'brute_force': 800, 'icmp_flood': 800, 'port_scan': 800, 'http_flood': 800}

  Features (10): ['packet_rate', 'unique_ports', 'avg_packet_size', 'duration', 'protocol_flag', 'connection_count', 'bytes_per_second', 'port_scan_ratio', 'size_rate_ratio', 'conn_rate']
  Raw: ['packet_rate', 'unique_ports', 'avg_packet_size', 'duration', 'protocol_flag', 'connection_count']
  Derived: ['bytes_per_second', 'port_scan_ratio', 'size_rate_ratio', 'conn_rate']

============================================================
  Data Split (70% train / 15% val / 15% test)
============================================================
  Normal â€” Train: 14,000  Val: 3,000  Test: 3,000
  Attack â€” Val: 1,200  Test: 1,200

  Fitting StandardScaler on TRAINING data only...
  Feature means (train): [2.2962000e+02 3.7400000e+00 7.1050000e+02 2.9540000e+01 5.1000000e-01
 5.3000000e+00 1.9683832e+05 6.6000000e-01 7.8600000e+00 1.0700000e+00]
  Feature stds  (train): [2.7221000e+02 3.4900000e+00 4.3387000e+02 3.9630000e+01 6.4000000e-01
 4.0600000e+00 2.7020054e+05 1.6800000e+00 1.1200000e+01 2.7100000e+00]
  Scaler saved to: D:\CN Final Project\ml\scaler.pkl

============================================================
  Hyperparameter Search (Validation Set)
============================================================

  Searched 81 combinations
  Best F1 on validation: 0.9856
  Best params: {'n_estimators': 100, 'contamination': 0.01, 'max_features': 0.75, 'max_samples': 0.5}

  Top 5 Configurations:
   n_est   contam   max_feat   max_samp       F1   Recall      FPR
     100     0.01       0.75        0.5   0.9856   0.9983   0.0110
     200     0.01        1.0       0.75   0.9852   0.9983   0.0113
     100     0.01        0.5       0.75   0.9848   0.9975   0.0113
     300     0.01        1.0       0.75   0.9848   0.9983   0.0117
     100     0.01       0.75       0.75   0.9840   0.9983   0.0123

============================================================
  Cross-Validation
============================================================

  5-Fold Cross-Validation:
    Fold 1: FP rate = 0.0079
    Fold 2: FP rate = 0.0136
    Fold 3: FP rate = 0.0114
    Fold 4: FP rate = 0.0082
    Fold 5: FP rate = 0.0129
    Average: 0.0108 Â± 0.0024

============================================================
  Training Final Isolation Forest (Best Params)
============================================================
  Params: {'n_estimators': 100, 'contamination': 0.01, 'max_features': 0.75, 'max_samples': 0.5}
  IF Model saved to: D:\CN Final Project\ml\model.pkl

============================================================
  Training Local Outlier Factor (for Ensemble)
============================================================
  LOF Model saved to: D:\CN Final Project\ml\ensemble_lof.pkl

============================================================
  Final Evaluation on HELD-OUT TEST SET
============================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Isolation Forest (tuned)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Normal correct:   2970/3000 (99.0%)
  False positives:  30/3000 (1.0%)
  Attacks detected: 1194/1200 (99.5%)
  Missed attacks:   6/1200

  Precision: 0.9755  Recall: 0.9950  F1: 0.9851  AUC: 0.9991
  Confusion Matrix:  TN=2970  FP=30  FN=6  TP=1194

  Per-Attack-Type Detection Rates:
  Attack Type                 Detected    Total     Rate
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  brute_force                      115      115  100.0%  âœ“
  dns_amplification                135      135  100.0%  âœ“
  http_flood                       127      128   99.2%  âœ“
  icmp_flood                        97       97  100.0%  âœ“
  port_scan                        127      127  100.0%  âœ“
  protocol_anomaly                 113      117   96.6%  âœ“
  slowloris                        105      105  100.0%  âœ“
  stealth_probe                    139      140   99.3%  âœ“
  syn_flood                        125      125  100.0%  âœ“
  udp_flood                        111      111  100.0%  âœ“

  Training One-Class SVM...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  One-Class SVM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Normal correct:   2845/3000 (94.8%)
  False positives:  155/3000 (5.2%)
  Attacks detected: 1200/1200 (100.0%)
  Missed attacks:   0/1200

  Precision: 0.8856  Recall: 1.0000  F1: 0.9393  AUC: 1.0000
  Confusion Matrix:  TN=2845  FP=155  FN=0  TP=1200

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Local Outlier Factor
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Normal correct:   2940/3000 (98.0%)
  False positives:  60/3000 (2.0%)
  Attacks detected: 1198/1200 (99.8%)
  Missed attacks:   2/1200

  Precision: 0.9523  Recall: 0.9983  F1: 0.9748  AUC: 0.9999
  Confusion Matrix:  TN=2940  FP=60  FN=2  TP=1198

============================================================
  Ensemble Model (IF 65% + LOF 35%, threshold=0.45)
============================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Ensemble (IF+LOF)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Normal correct:   2970/3000 (99.0%)
  False positives:  30/3000 (1.0%)
  Attacks detected: 1194/1200 (99.5%)
  Missed attacks:   6/1200

  Precision: 0.9755  Recall: 0.9950  F1: 0.9851  AUC: 0.9991
  Confusion Matrix:  TN=2970  FP=30  FN=6  TP=1194

  Per-Attack-Type Detection Rates:
  Attack Type                 Detected    Total     Rate
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  brute_force                      115      115  100.0%  âœ“
  dns_amplification                135      135  100.0%  âœ“
  http_flood                       127      128   99.2%  âœ“
  icmp_flood                        97       97  100.0%  âœ“
  port_scan                        127      127  100.0%  âœ“
  protocol_anomaly                 113      117   96.6%  âœ“
  slowloris                        105      105  100.0%  âœ“
  stealth_probe                    139      140   99.3%  âœ“
  syn_flood                        125      125  100.0%  âœ“
  udp_flood                        111      111  100.0%  âœ“

============================================================
  Model Comparison Summary
============================================================
  Model                                     F1   Recall      AUC      FPR
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Isolation Forest (tuned)              0.9851   0.9950   0.9991   0.0100
  One-Class SVM                         0.9393   1.0000   1.0000   0.0517
  Local Outlier Factor                  0.9748   0.9983   0.9999   0.0200
  Ensemble (IF+LOF)                     0.9851   0.9950   0.9991   0.0100

============================================================
  Learning Curve Analysis
============================================================
    10% (  1400 samples) â†’ train_acc=0.9900  val_F1=0.9719  test_F1=0.9772  val_FPR=0.0143
    20% (  2800 samples) â†’ train_acc=0.9900  val_F1=0.9732  test_F1=0.9764  val_FPR=0.0147
    30% (  4200 samples) â†’ train_acc=0.9900  val_F1=0.9807  test_F1=0.9786  val_FPR=0.0137
    50% (  7000 samples) â†’ train_acc=0.9900  val_F1=0.9828  test_F1=0.9843  val_FPR=0.0133
    70% (  9800 samples) â†’ train_acc=0.9900  val_F1=0.9820  test_F1=0.9839  val_FPR=0.0137
    85% ( 11900 samples) â†’ train_acc=0.9900  val_F1=0.9844  test_F1=0.9856  val_FPR=0.0113
   100% ( 14000 samples) â†’ train_acc=0.9900  val_F1=0.9856  test_F1=0.9851  val_FPR=0.0110

  âœ“ No overfitting detected (F1 stable or improving, train-test gap=0.0000)

============================================================
  Feature Importance (Permutation, 10 repeats)
============================================================
  Feature                      Mean       Â±Std   Relative
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  bytes_per_second         0.014316   0.000179      15.6%
  packet_rate              0.012590   0.000190      13.7%
  avg_packet_size          0.011592   0.000182      12.7%
  conn_rate                0.009427   0.000138      10.3%
  connection_count         0.009166   0.000139      10.0%
  port_scan_ratio          0.008834   0.000125       9.6%
  duration                 0.008455   0.000111       9.2%
  unique_ports             0.006313   0.000152       6.9%
  size_rate_ratio          0.005542   0.000098       6.1%
  protocol_flag            0.005342   0.000147       5.8%

============================================================
  Generating Visualizations
============================================================
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\confusion_matrix.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\confusion_matrices_all.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\roc_curves.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\learning_curves.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\per_attack_detection.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\feature_importance.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\score_distribution.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\model_comparison.png
  ðŸ“Š Saved: D:\CN Final Project\ml\plots\cross_validation.png
  ðŸ“„ Report saved: D:\CN Final Project\ml\TRAINING_REPORT.md

============================================================
  Training Pipeline Complete! (72.8s)
============================================================
  Model (IF):      D:\CN Final Project\ml\model.pkl
  Model (LOF):     D:\CN Final Project\ml\ensemble_lof.pkl
  Scaler:          D:\CN Final Project\ml\scaler.pkl
  Metrics:         D:\CN Final Project\ml\training_metrics.json
  Report:          D:\CN Final Project\ml\TRAINING_REPORT.md
  Training Log:    D:\CN Final Project\ml\training.log
  Plots:           D:\CN Final Project\ml\plots/

  Visualizations Generated:
    âœ“ ml/plots/confusion_matrix.png
    âœ“ ml/plots/confusion_matrices_all.png
    âœ“ ml/plots/roc_curves.png
    âœ“ ml/plots/learning_curves.png
    âœ“ ml/plots/per_attack_detection.png
    âœ“ ml/plots/feature_importance.png
    âœ“ ml/plots/score_distribution.png
    âœ“ ml/plots/model_comparison.png
    âœ“ ml/plots/cross_validation.png
============================================================
