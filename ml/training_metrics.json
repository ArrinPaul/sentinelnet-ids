{
  "training_timestamp": "2026-02-10 14:51:55",
  "training_duration_seconds": 72.8,
  "pipeline_version": "3.0 (ensemble + visualizations)",
  "dataset": {
    "normal_total": 20000,
    "attack_total": 8000,
    "normal_train": 14000,
    "normal_val": 3000,
    "normal_test": 3000,
    "attack_val": 1200,
    "attack_test": 1200
  },
  "features": {
    "all": [
      "packet_rate",
      "unique_ports",
      "avg_packet_size",
      "duration",
      "protocol_flag",
      "connection_count",
      "bytes_per_second",
      "port_scan_ratio",
      "size_rate_ratio",
      "conn_rate"
    ],
    "raw": [
      "packet_rate",
      "unique_ports",
      "avg_packet_size",
      "duration",
      "protocol_flag",
      "connection_count"
    ],
    "derived": [
      "bytes_per_second",
      "port_scan_ratio",
      "size_rate_ratio",
      "conn_rate"
    ],
    "count": 10
  },
  "scaler": {
    "means": [
      229.61837857142848,
      3.7375,
      710.5035214285704,
      29.54369999999992,
      0.5053571428571428,
      5.301214285714286,
      196838.3209285703,
      0.6625619857142843,
      7.85813477142861,
      1.0707732571428554
    ],
    "stds": [
      272.2097988449861,
      3.48652828244463,
      433.872912684316,
      39.625045132322136,
      0.643072880466826,
      4.056377512696643,
      270200.53924764035,
      1.681367597744013,
      11.20219456357212,
      2.713585211418214
    ]
  },
  "best_hyperparameters": {
    "n_estimators": 100,
    "contamination": 0.01,
    "max_features": 0.75,
    "max_samples": 0.5
  },
  "hyperparameter_search": {
    "total_combinations": 81,
    "top_5": [
      {
        "n_estimators": 100,
        "contamination": 0.01,
        "max_features": 0.75,
        "max_samples": "0.5",
        "f1": 0.9856,
        "recall": 0.9983,
        "fpr": 0.011
      },
      {
        "n_estimators": 200,
        "contamination": 0.01,
        "max_features": 1.0,
        "max_samples": "0.75",
        "f1": 0.9852,
        "recall": 0.9983,
        "fpr": 0.0113
      },
      {
        "n_estimators": 100,
        "contamination": 0.01,
        "max_features": 0.5,
        "max_samples": "0.75",
        "f1": 0.9848,
        "recall": 0.9975,
        "fpr": 0.0113
      },
      {
        "n_estimators": 300,
        "contamination": 0.01,
        "max_features": 1.0,
        "max_samples": "0.75",
        "f1": 0.9848,
        "recall": 0.9983,
        "fpr": 0.0117
      },
      {
        "n_estimators": 100,
        "contamination": 0.01,
        "max_features": 0.75,
        "max_samples": "0.75",
        "f1": 0.984,
        "recall": 0.9983,
        "fpr": 0.0123
      }
    ]
  },
  "cross_validation": {
    "avg_fp_rate": 0.0108,
    "std_fp_rate": 0.0024,
    "fold_fp_rates": [
      0.0079,
      0.0136,
      0.0114,
      0.0082,
      0.0129
    ]
  },
  "model_metrics": {
    "isolation_forest": {
      "model": "Isolation Forest (tuned)",
      "precision": 0.9755,
      "recall": 0.995,
      "f1_score": 0.9851,
      "roc_auc": 0.9991,
      "normal_accuracy": 0.99,
      "attack_detection_rate": 0.995,
      "false_positive_rate": 0.01,
      "confusion_matrix": [
        [
          2970,
          30
        ],
        [
          6,
          1194
        ]
      ],
      "per_attack_type": {
        "brute_force": {
          "detected": 115,
          "total": 115,
          "rate": 1.0
        },
        "dns_amplification": {
          "detected": 135,
          "total": 135,
          "rate": 1.0
        },
        "http_flood": {
          "detected": 127,
          "total": 128,
          "rate": 0.9922
        },
        "icmp_flood": {
          "detected": 97,
          "total": 97,
          "rate": 1.0
        },
        "port_scan": {
          "detected": 127,
          "total": 127,
          "rate": 1.0
        },
        "protocol_anomaly": {
          "detected": 113,
          "total": 117,
          "rate": 0.9658
        },
        "slowloris": {
          "detected": 105,
          "total": 105,
          "rate": 1.0
        },
        "stealth_probe": {
          "detected": 139,
          "total": 140,
          "rate": 0.9929
        },
        "syn_flood": {
          "detected": 125,
          "total": 125,
          "rate": 1.0
        },
        "udp_flood": {
          "detected": 111,
          "total": 111,
          "rate": 1.0
        }
      }
    },
    "one_class_svm": {
      "model": "One-Class SVM",
      "precision": 0.8856,
      "recall": 1.0,
      "f1_score": 0.9393,
      "roc_auc": 1.0,
      "normal_accuracy": 0.9483,
      "attack_detection_rate": 1.0,
      "false_positive_rate": 0.0517,
      "confusion_matrix": [
        [
          2845,
          155
        ],
        [
          0,
          1200
        ]
      ]
    },
    "local_outlier_factor": {
      "model": "Local Outlier Factor",
      "precision": 0.9523,
      "recall": 0.9983,
      "f1_score": 0.9748,
      "roc_auc": 0.9999,
      "normal_accuracy": 0.98,
      "attack_detection_rate": 0.9983,
      "false_positive_rate": 0.02,
      "confusion_matrix": [
        [
          2940,
          60
        ],
        [
          2,
          1198
        ]
      ]
    },
    "ensemble": {
      "model": "Ensemble (IF+LOF)",
      "precision": 0.9755,
      "recall": 0.995,
      "f1_score": 0.9851,
      "roc_auc": 0.9991,
      "normal_accuracy": 0.99,
      "attack_detection_rate": 0.995,
      "false_positive_rate": 0.01,
      "confusion_matrix": [
        [
          2970,
          30
        ],
        [
          6,
          1194
        ]
      ],
      "per_attack_type": {
        "brute_force": {
          "detected": 115,
          "total": 115,
          "rate": 1.0
        },
        "dns_amplification": {
          "detected": 135,
          "total": 135,
          "rate": 1.0
        },
        "http_flood": {
          "detected": 127,
          "total": 128,
          "rate": 0.9922
        },
        "icmp_flood": {
          "detected": 97,
          "total": 97,
          "rate": 1.0
        },
        "port_scan": {
          "detected": 127,
          "total": 127,
          "rate": 1.0
        },
        "protocol_anomaly": {
          "detected": 113,
          "total": 117,
          "rate": 0.9658
        },
        "slowloris": {
          "detected": 105,
          "total": 105,
          "rate": 1.0
        },
        "stealth_probe": {
          "detected": 139,
          "total": 140,
          "rate": 0.9929
        },
        "syn_flood": {
          "detected": 125,
          "total": 125,
          "rate": 1.0
        },
        "udp_flood": {
          "detected": 111,
          "total": 111,
          "rate": 1.0
        }
      }
    }
  },
  "learning_curve": [
    {
      "fraction": 0.1,
      "n_samples": 1400,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9719,
      "val_fpr": 0.0143,
      "val_recall": 0.9792,
      "val_precision": 0.9647,
      "val_accuracy": 0.9857,
      "test_f1": 0.9772,
      "test_fpr": 0.0107,
      "test_recall": 0.9808,
      "test_accuracy": 0.9893
    },
    {
      "fraction": 0.2,
      "n_samples": 2800,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9732,
      "val_fpr": 0.0147,
      "val_recall": 0.9825,
      "val_precision": 0.964,
      "val_accuracy": 0.9853,
      "test_f1": 0.9764,
      "test_fpr": 0.0123,
      "test_recall": 0.9833,
      "test_accuracy": 0.9877
    },
    {
      "fraction": 0.3,
      "n_samples": 4200,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9807,
      "val_fpr": 0.0137,
      "val_recall": 0.995,
      "val_precision": 0.9668,
      "val_accuracy": 0.9863,
      "test_f1": 0.9786,
      "test_fpr": 0.0137,
      "test_recall": 0.9908,
      "test_accuracy": 0.9863
    },
    {
      "fraction": 0.5,
      "n_samples": 7000,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9828,
      "val_fpr": 0.0133,
      "val_recall": 0.9983,
      "val_precision": 0.9677,
      "val_accuracy": 0.9867,
      "test_f1": 0.9843,
      "test_fpr": 0.011,
      "test_recall": 0.9958,
      "test_accuracy": 0.989
    },
    {
      "fraction": 0.7,
      "n_samples": 9800,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.982,
      "val_fpr": 0.0137,
      "val_recall": 0.9975,
      "val_precision": 0.9669,
      "val_accuracy": 0.9863,
      "test_f1": 0.9839,
      "test_fpr": 0.0107,
      "test_recall": 0.9942,
      "test_accuracy": 0.9893
    },
    {
      "fraction": 0.85,
      "n_samples": 11900,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9844,
      "val_fpr": 0.0113,
      "val_recall": 0.9967,
      "val_precision": 0.9724,
      "val_accuracy": 0.9887,
      "test_f1": 0.9856,
      "test_fpr": 0.01,
      "test_recall": 0.9958,
      "test_accuracy": 0.99
    },
    {
      "fraction": 1.0,
      "n_samples": 14000,
      "train_accuracy": 0.99,
      "train_fpr": 0.01,
      "val_f1": 0.9856,
      "val_fpr": 0.011,
      "val_recall": 0.9983,
      "val_precision": 0.9732,
      "val_accuracy": 0.989,
      "test_f1": 0.9851,
      "test_fpr": 0.01,
      "test_recall": 0.995,
      "test_accuracy": 0.99
    }
  ],
  "feature_importance": {
    "bytes_per_second": {
      "mean": 0.014316,
      "std": 0.000179,
      "relative": 15.63
    },
    "packet_rate": {
      "mean": 0.01259,
      "std": 0.00019,
      "relative": 13.75
    },
    "avg_packet_size": {
      "mean": 0.011592,
      "std": 0.000182,
      "relative": 12.66
    },
    "conn_rate": {
      "mean": 0.009427,
      "std": 0.000138,
      "relative": 10.29
    },
    "connection_count": {
      "mean": 0.009166,
      "std": 0.000139,
      "relative": 10.01
    },
    "port_scan_ratio": {
      "mean": 0.008834,
      "std": 0.000125,
      "relative": 9.65
    },
    "duration": {
      "mean": 0.008455,
      "std": 0.000111,
      "relative": 9.23
    },
    "unique_ports": {
      "mean": 0.006313,
      "std": 0.000152,
      "relative": 6.89
    },
    "size_rate_ratio": {
      "mean": 0.005542,
      "std": 9.8e-05,
      "relative": 6.05
    },
    "protocol_flag": {
      "mean": 0.005342,
      "std": 0.000147,
      "relative": 5.83
    }
  },
  "ensemble_config": {
    "if_weight": 0.65,
    "lof_weight": 0.35,
    "threshold": 0.45
  },
  "visualizations": [
    "ml/plots/confusion_matrix.png",
    "ml/plots/confusion_matrices_all.png",
    "ml/plots/roc_curves.png",
    "ml/plots/learning_curves.png",
    "ml/plots/per_attack_detection.png",
    "ml/plots/feature_importance.png",
    "ml/plots/score_distribution.png",
    "ml/plots/model_comparison.png",
    "ml/plots/cross_validation.png"
  ]
}